## 第3章 整值函数

### 热身题

#### 1

注意到
$$
\begin{aligned}
2^m &\le 2^m + l < 2^{m} + 2^m\\
m &\le \log_2(2^m + l) <m+1\\
m&\le \log_2 n < m+1
\end{aligned}
$$
所以
$$
m = \lfloor \log_2n \rfloor
$$
因此
$$
\begin{aligned}
m &= \lfloor \log_2n \rfloor\\
l &= n -2^{\lfloor \log_2n \rfloor}

\end{aligned}
$$



#### 2

如果$x \ge \lfloor x\rfloor + 0.5$，那么结果为$\lceil x \rceil$，否则结果为$\lfloor x\rfloor$，因此结果为
$$
\lceil x \rceil [x \ge \lfloor x\rfloor + 0.5] + 
\lfloor x \rfloor [x < \lfloor x\rfloor + 0.5]
$$



#### 3

$$
\begin{aligned}
m\alpha- 1&< \lfloor m \alpha\rfloor \le  m\alpha\\
(m\alpha- 1)n&< \lfloor m \alpha\rfloor n  \le  m\alpha n\\
mn-1<mn - n/\alpha &< \lfloor m \alpha\rfloor n /\alpha  \le  mn
\end{aligned}
$$

注意到$\alpha$为无理数，所以
$$
mn-1<mn - n/\alpha < \lfloor m \alpha\rfloor n /\alpha <  mn
$$
因此
$$
\lfloor\lfloor m \alpha\rfloor n /\alpha\rfloor  = mn-1
$$


#### 4

个人感觉水平0应该是计算。



#### 5


$$
\begin{aligned}
\lfloor n x\rfloor&=n\lfloor x\rfloor && \Leftrightarrow \\
\lfloor n (\lfloor x\rfloor + \{x\})\rfloor &= n\lfloor x\rfloor && \Leftrightarrow\\
\lfloor n \lfloor x\rfloor +n \{x\}\rfloor&= n\lfloor x\rfloor && \Leftrightarrow\\
n \lfloor x\rfloor +\lfloor n \{x\}\rfloor &= n\lfloor x\rfloor && \Leftrightarrow\\
\lfloor n \{x\}\rfloor  &= 0&& \Leftrightarrow\\
 n \{x\} & < 1&& \Leftrightarrow\\
 \{x\} & <\frac 1 n 
\end{aligned}
$$



#### 6

结论是：
$$
\begin{aligned}
\lfloor f(x)\rfloor&=\lfloor f(\lceil x\rceil )\rfloor\\
\lceil f(x)\rceil &=\lceil f(\lfloor x\rfloor)\rceil

\end{aligned}
$$
只证明第一个结论，第二个结论同理可得。

证明：

如果$x = \lceil x\rceil$，那么结论显然成立。

否则$x < \lceil x\rceil$，由$f$递减可得：
$$
\begin{aligned}
f(x)&> f(\lceil x\rceil) \\
\lfloor f(x)\rfloor & \ge \lfloor f(\lceil x\rceil)\rfloor
\end{aligned}
$$
如果$\lfloor f(x)\rfloor > \lfloor f(\lceil x\rceil)\rfloor$，注意到
$$
\begin{aligned}
\lfloor f(x)\rfloor& \le f(x)  < \lfloor f(x)\rfloor + 1\\
\lfloor f(\lceil x\rceil)\rfloor& \le f(\lceil x\rceil)  < \lfloor f(\lceil x\rceil)\rfloor + 1
\end{aligned}
$$
因此
$$
\begin{aligned}
f(x)&\ge \lfloor f(x)\rfloor \\
&\ge \lfloor f(\lceil x\rceil)\rfloor + 1 && 根据条件\\
& > f(\lceil x\rceil)

\end{aligned}
$$
由函数的连续性可得存在$x\le y < \lceil x\rceil$，满足
$$
f(y) = \lfloor f(x)\rfloor
$$
这推出$y$为整数，但是这与$x\le y < \lceil x\rceil$矛盾。



#### 7

$$
\begin{aligned}
X_{n}&=X_{n-m}+1\\
&= X_{n- m\lfloor n/m \rfloor} +  \lfloor n/m \rfloor \\
&= n- m\lfloor n/m \rfloor +  \lfloor n/m \rfloor\\
&= (n\text{ mod }m) +  \lfloor n/m \rfloor\
\end{aligned}
$$



#### 8

利用反证法。

如果每个盒子的物品数量$< \lceil n / m\rceil$，注意到物品数量为整数，这等价于每个盒子的物品数量$\le  \lceil n / m\rceil - 1$，那么物品总数
$$
\le  m \times (\lceil n / m\rceil-1) <m \times n / m = n
$$
这就产生了矛盾。

如果每个盒子的物品数量$> \lfloor n / m\rfloor$，注意到物品数量为整数，这等价于每个盒子的物品数量$\ge  \lfloor n / m\rfloor + 1$，那么物品总数
$$
\ge m\times (\lfloor n / m\rfloor + 1) > m \times (n/m)=n
$$
这就产生了矛盾。



#### 9

考虑递归的转换过程：
$$
(m,n)\to (mq-n, nq)
$$
只要证明$mq-n < m$即可，因为如果该性质满足，那么最多经过$m-1$步，$mq-n$就会变成$1$，递归停止。

注意到
$$
\begin{aligned}
\frac n m &\le q =\left\lceil \frac n m \right\rceil< \frac n m + 1\\
n &\le m q < n + m\\
0&\le mq- n< m

\end{aligned}
$$
因此结论成立。



### 基础题

#### 10

注意到
$$
\left\lceil \frac{2 x+1}{4}\right \rceil-\left\lfloor\frac{2 x+1}{4}\right\rfloor=\begin{cases}
1 & \frac{2 x+1}{4}不是整数\\
0 & \frac{2 x+1}{4}是整数
\end{cases}
$$
所以
$$
\begin{aligned}
\left\lceil\frac{2 x+1}{2}\right\rceil-\left\lceil\frac{2 x+1}{4}\right\rceil+\left\lfloor\frac{2 x+1}{4}\right\rfloor
&= \left\lceil\frac{2 x+1}{2}\right\rceil-r \\
&=  \left\lceil x +\frac 1 2  - r\right\rceil \\
&=\begin{cases}
 \left\lceil x -\frac 1 2 \right\rceil & \frac{2 x+1}{4}不是整数\\
\left\lceil x +\frac 1 2 \right\rceil & \frac{2 x+1}{4}是整数
\end{cases}
\end{aligned}
$$
注意到$\frac{2x+1}{4}$为整数等价于
$$
x= 2k-\frac 1 2 , k\in \mathbb Z
$$
所以此时
$$
\left\lceil x +\frac 1 2 \right\rceil = 2k =\lceil x \rceil
$$
另一方面
$$
\begin{aligned}
\left\lceil x -\frac 1 2 \right\rceil
&=\left\lceil \lfloor x \rfloor +\{x\}-\frac 1 2 \right\rceil\\

&=\begin{cases}
 \lfloor x \rfloor & \{x\} \le \frac 1 2\\
 \lfloor x \rfloor +1  & \{x\}> \frac 1 2
\end{cases}\\
&= \begin{cases}
 \lfloor x \rfloor & \{x\} \le \frac 1 2\\
 \lceil x \rceil  & \{x\}> \frac 1 2
\end{cases}

\end{aligned}
$$
综上
$$
\begin{aligned}
\left\lceil\frac{2 x+1}{2}\right\rceil-\left\lceil\frac{2 x+1}{4}\right\rceil+\left\lfloor\frac{2 x+1}{4}\right\rfloor
&=\begin{cases}
 \left\lceil x -\frac 1 2 \right\rceil & \frac{2 x+1}{4}不是整数\\
\left\lceil x +\frac 1 2 \right\rceil & \frac{2 x+1}{4}是整数
\end{cases}\\
&=\begin{cases}
 
\left\lceil x \right\rceil & \frac{2 x+1}{4}是整数或\{x\}>\frac 1 2 \\
\lfloor x \rfloor & 其他\\
\end{cases}
\end{aligned}
$$



#### 11

如果$\alpha= \beta$，区间$(\alpha,\beta) =\varnothing$，所以要排除。

如果$\alpha <\beta$，假设整数$n$在该区间内，那么
$$
\alpha < n < \beta
$$
根据73页3.7可得，这等价于
$$
\lfloor  \alpha \rfloor < n < \lceil \beta\rceil
$$
所以$(\alpha,\beta)$内的整数为
$$
\lfloor  \alpha \rfloor + 1 ,\ldots,  \lceil \beta\rceil -1
$$
因此整数数量为
$$
\lceil \beta\rceil -1 - \lfloor  \alpha \rfloor - 1 + 1 =\lceil \beta\rceil- \lfloor  \alpha \rfloor - 1
$$



#### 12

假设
$$
n = km + r, 0\le r < m
$$
那么
$$
\begin{aligned}
\left\lceil \frac{n}{m}\right\rceil &= k + [r\ne 0] \\
\left\lfloor\frac{n+m-1}{m}\right\rfloor &=
\left\lfloor\frac{km+r+m-1}{m}\right\rfloor \\
&=k+1 +\left\lfloor\frac{r-1}{m}\right\rfloor \\
&= k+1- [r= 0] \\
&=k + [r\ne 0] 
\end{aligned}
$$
因此
$$
\left\lceil \frac{n}{m}\right\rceil=\left\lfloor\frac{n+m-1}{m}\right\rfloor
$$



#### 13

结合课本80页的结论，$\operatorname{Spec}(\alpha)$ 和 $\operatorname{Spec}(\beta)$ 给出了正整数的划分等价于，对于任意的$n\in \mathbb Z^+$，都有
$$
\begin{aligned}
\left\lfloor \frac{n+1}{\alpha}\right\rfloor+\left\lfloor\frac{n+1}{\beta}\right\rfloor&=n \\
\frac{n+1}{\alpha}-\left\{ \frac{n+1}{\alpha}\right\}+\frac{n+1}{\beta}-\left\{ \frac{n+1}{\beta}\right\}&=n\\
(n+1)\left(\frac 1\alpha + \frac 1 \beta - 1\right)
&= \left\{ \frac{n+1}{\alpha}\right\}+\left\{ \frac{n+1}{\beta}\right\} - 1
\end{aligned}
$$
接着分两个方向证明。

$\Rightarrow$：

注意到
$$
\left\{ \frac{n+1}{\alpha}\right\}+\left\{ \frac{n+1}{\beta}\right\} - 1 \in [-1, 1)
$$
因此
$$
\begin{aligned}
\left| (n+1)\left(\frac 1\alpha + \frac 1 \beta - 1\right)\right| &\le 1,\forall n\in \mathbb Z^+ \\
\left|\left(\frac 1\alpha + \frac 1 \beta - 1\right)\right| &\le \frac 1 { n+1},\forall n\in \mathbb Z^+ \\
\end{aligned}
$$
令$n\to \infty$可得
$$
\begin{aligned}
\left| \frac 1\alpha + \frac 1 \beta -  1 \right| &\le 0\\
\frac 1\alpha + \frac 1 \beta &=  1

\end{aligned}
$$
$\Leftarrow$：

如果
$$
\frac 1\alpha + \frac 1 \beta = 1
$$
要证明
$$
(n+1)\left(\frac 1\alpha + \frac 1 \beta - 1\right)
= \left\{ \frac{n+1}{\alpha}\right\}+\left\{ \frac{n+1}{\beta}\right\} - 1
$$
只需证明
$$
\left\{ \frac{n+1}{\alpha}\right\}+\left\{ \frac{n+1}{\beta}\right\} - 1=0
$$
注意到$\frac{n+1}{\alpha}$和$\frac{n+1}{\beta}$都是无理数，且和为整数：
$$
\frac{n+1}{\alpha}+ \frac{n+1}{\beta}=n+1
$$
因此下式成立：
$$
\left\{ \frac{n+1}{\alpha}\right\}+\left\{ \frac{n+1}{\beta}\right\} - 1=0
$$

结论得证。



#### 14

注意到
$$
x \bmod y = z \bmod y \Leftrightarrow x-z = ky, k\in\mathbb Z
$$
所以该命题等价于
$$
\begin{aligned}
(x \bmod ny) - x &= ky, k\in \mathbb Z\\
x- ny\lfloor x/ (ny)\rfloor - x & = ky , k\in \mathbb Z\\
- ny\lfloor x/ (ny)\rfloor & = ky, k\in \mathbb Z\\
-n\lfloor x/ (ny)\rfloor & = k,k\in \mathbb Z
\end{aligned}
$$
因此结论成立。



#### 15

考虑71页3.24
$$
n=\left\lceil\frac{n}{m}\right\rceil+\left\lceil\frac{n-1}{m}\right\rceil+\cdots+\left\lceil\frac{n-m+1}{m}\right \rceil
$$
取
$$
n=\left\lceil m x\right\rceil
$$
利用60页3.11可得
$$
\begin{aligned}
\left\lceil m x\right\rceil
&=\left\lceil\frac{\lceil m x \rceil}{m}\right\rceil+\left\lceil\frac{\lceil m x \rceil-1}{m}\right\rceil+\cdots+\left\lceil\frac{\lceil m x \rceil-m+1}{m}\right \rceil \\
&=\left\lceil\frac{ m x }{m}\right\rceil+\left\lceil\frac{m x -1}{m}\right\rceil+\cdots+\left\lceil\frac{ m x -m+1}{m}\right \rceil\\
&= \left\lceil x\right\rceil+\left\lceil x-\frac{ 1}{m}\right\rceil+\cdots+\left\lceil x-\frac{m-1}{m}\right \rceil
\end{aligned}
$$


#### 16

这里$n$应该是指整数，所以
$$
n \bmod 2=\begin{cases}
0 & n = 2k, k\in \mathbb Z\\
1 & n = 2k+1, k\in \mathbb Z
\end{cases}= \left(1-(-1)^{n}\right) / 2
$$
对于另一种情形：
$$
n \bmod 3=\begin{cases}
0 & n = 3k, k\in \mathbb Z\\
1 & n = 3k+1, k\in \mathbb Z\\
2 & n = 3k+2, k\in \mathbb Z\\
\end{cases}
$$
现在需要用下式统一表达
$$
a+b \omega^{n}+c \omega^{2 n}
$$
因此
$$
\begin{aligned}
&\begin{cases}
a + b\omega^{3k} + c \omega^{6k} = 0\\
a + b\omega^{3k+1} + c \omega^{6k+2} = 1\\
a + b\omega^{3k+2} + c \omega^{6k+4} = 2
\end{cases}\\

&\begin{cases}
a + b + c  = 0\\
a + b\omega + c \omega^2 = 1\\
a + b\omega^2 + c \omega^4 = 2
\end{cases}\\

\end{aligned}
$$
求解可得
$$
\begin{cases}
a = 1\\
b = -\frac{\omega}{\omega- 1}\\
c= \frac{1}{\omega - 1}
\end{cases}
$$
因此
$$
n \bmod 3=1- \frac{\omega^{n+1} -\omega^{2n} }{\omega - 1}
$$


### 重点

6